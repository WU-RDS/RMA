<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 Assignments: Solutions | Retail Marketing Analytics 2024</title>
  <meta name="description" content="An Introduction to Data Analytics Using R" />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="9 Assignments: Solutions | Retail Marketing Analytics 2024" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="An Introduction to Data Analytics Using R" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 Assignments: Solutions | Retail Marketing Analytics 2024" />
  
  <meta name="twitter:description" content="An Introduction to Data Analytics Using R" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="r-markdown.html"/>
<link rel="next" href="group-project-1.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">RMA 2024</a></strong></li>

<li class="divider"></li>
<li class="part"><span><b>I Course outline</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome!</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#course-structure"><i class="fa fa-check"></i>Course structure</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#schedule"><i class="fa fa-check"></i>Schedule</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#grading"><i class="fa fa-check"></i>Grading</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#course-materials"><i class="fa fa-check"></i>Course materials</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#main-reference"><i class="fa fa-check"></i>Main reference</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#further-readings"><i class="fa fa-check"></i>Further readings</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#discussion-forum"><i class="fa fa-check"></i>Discussion forum</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#other-web-resources"><i class="fa fa-check"></i>Other web-resources</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#contact"><i class="fa fa-check"></i>Contact</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Lecture notes</b></span></li>
<li class="chapter" data-level="1" data-path="preliminaries.html"><a href="preliminaries.html"><i class="fa fa-check"></i><b>1</b> Preliminaries</a>
<ul>
<li class="chapter" data-level="1.1" data-path="preliminaries.html"><a href="preliminaries.html#marketing-foundations-recap"><i class="fa fa-check"></i><b>1.1</b> Marketing foundations (recap)</a></li>
<li class="chapter" data-level="1.2" data-path="preliminaries.html"><a href="preliminaries.html#the-research-process"><i class="fa fa-check"></i><b>1.2</b> The research process</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="preliminaries.html"><a href="preliminaries.html#research-question-and-hypothesis"><i class="fa fa-check"></i><b>1.2.1</b> Research question and hypothesis</a></li>
<li class="chapter" data-level="1.2.2" data-path="preliminaries.html"><a href="preliminaries.html#choosing-a-research-design"><i class="fa fa-check"></i><b>1.2.2</b> Choosing a research design</a></li>
<li class="chapter" data-level="1.2.3" data-path="preliminaries.html"><a href="preliminaries.html#collecting-data"><i class="fa fa-check"></i><b>1.2.3</b> Collecting data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="preliminaries.html"><a href="preliminaries.html#learning-check"><i class="fa fa-check"></i>Learning check</a></li>
<li class="chapter" data-level="" data-path="preliminaries.html"><a href="preliminaries.html#references"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html"><i class="fa fa-check"></i><b>2</b> Getting started with R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#how-to-download-and-install-r-and-rstudio"><i class="fa fa-check"></i><b>2.1</b> How to download and install R and RStudio</a></li>
<li class="chapter" data-level="2.2" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#the-r-studio-interface"><i class="fa fa-check"></i><b>2.2</b> The R Studio interface</a></li>
<li class="chapter" data-level="2.3" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#functions"><i class="fa fa-check"></i><b>2.3</b> Functions</a></li>
<li class="chapter" data-level="2.4" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#packages"><i class="fa fa-check"></i><b>2.4</b> Packages</a></li>
<li class="chapter" data-level="2.5" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#a-typical-r-session"><i class="fa fa-check"></i><b>2.5</b> A typical R session</a></li>
<li class="chapter" data-level="2.6" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#getting-help"><i class="fa fa-check"></i><b>2.6</b> Getting help</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-handling.html"><a href="data-handling.html"><i class="fa fa-check"></i><b>3</b> Data handling</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-handling.html"><a href="data-handling.html#basic-data-handling"><i class="fa fa-check"></i><b>3.1</b> Basic data handling</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="data-handling.html"><a href="data-handling.html#creating-objects"><i class="fa fa-check"></i><b>3.1.1</b> Creating objects</a></li>
<li class="chapter" data-level="3.1.2" data-path="data-handling.html"><a href="data-handling.html#data-types"><i class="fa fa-check"></i><b>3.1.2</b> Data types</a></li>
<li class="chapter" data-level="3.1.3" data-path="data-handling.html"><a href="data-handling.html#data-structures"><i class="fa fa-check"></i><b>3.1.3</b> Data structures</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="data-handling.html"><a href="data-handling.html#data-import-and-export"><i class="fa fa-check"></i><b>3.2</b> Data import and export</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data-handling.html"><a href="data-handling.html#getting-data-for-this-course"><i class="fa fa-check"></i><b>3.2.1</b> Getting data for this course</a></li>
<li class="chapter" data-level="3.2.2" data-path="data-handling.html"><a href="data-handling.html#export-data"><i class="fa fa-check"></i><b>3.2.2</b> Export data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data-handling.html"><a href="data-handling.html#learning-check-1"><i class="fa fa-check"></i>Learning check</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="summarizing-data.html"><a href="summarizing-data.html"><i class="fa fa-check"></i><b>4</b> Summarizing data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="summarizing-data.html"><a href="summarizing-data.html#summary-statistics"><i class="fa fa-check"></i><b>4.1</b> Summary statistics</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="summarizing-data.html"><a href="summarizing-data.html#categorical-variables"><i class="fa fa-check"></i><b>4.1.1</b> Categorical variables</a></li>
<li class="chapter" data-level="4.1.2" data-path="summarizing-data.html"><a href="summarizing-data.html#continuous-variables"><i class="fa fa-check"></i><b>4.1.2</b> Continuous variables</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="summarizing-data.html"><a href="summarizing-data.html#data-visualization"><i class="fa fa-check"></i><b>4.2</b> Data visualization</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="summarizing-data.html"><a href="summarizing-data.html#categorical-variables-1"><i class="fa fa-check"></i><b>4.2.1</b> Categorical variables</a></li>
<li class="chapter" data-level="4.2.2" data-path="summarizing-data.html"><a href="summarizing-data.html#continuous-variables-1"><i class="fa fa-check"></i><b>4.2.2</b> Continuous variables</a></li>
<li class="chapter" data-level="4.2.3" data-path="summarizing-data.html"><a href="summarizing-data.html#saving-plots"><i class="fa fa-check"></i><b>4.2.3</b> Saving plots</a></li>
<li class="chapter" data-level="4.2.4" data-path="summarizing-data.html"><a href="summarizing-data.html#ggplot-extensions"><i class="fa fa-check"></i><b>4.2.4</b> ggplot extensions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="summarizing-data.html"><a href="summarizing-data.html#learning-check-2"><i class="fa fa-check"></i>Learning check</a></li>
<li class="chapter" data-level="" data-path="summarizing-data.html"><a href="summarizing-data.html#references-1"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="statistical-inference.html"><a href="statistical-inference.html"><i class="fa fa-check"></i><b>5</b> Statistical inference</a>
<ul>
<li class="chapter" data-level="5.1" data-path="statistical-inference.html"><a href="statistical-inference.html#if-we-knew-it-all"><i class="fa fa-check"></i><b>5.1</b> If we knew it all</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="statistical-inference.html"><a href="statistical-inference.html#sampling-from-a-known-population"><i class="fa fa-check"></i><b>5.1.1</b> Sampling from a known population</a></li>
<li class="chapter" data-level="5.1.2" data-path="statistical-inference.html"><a href="statistical-inference.html#standard-error-of-the-mean"><i class="fa fa-check"></i><b>5.1.2</b> Standard error of the mean</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="statistical-inference.html"><a href="statistical-inference.html#the-central-limit-theorem"><i class="fa fa-check"></i><b>5.2</b> The Central Limit Theorem</a></li>
<li class="chapter" data-level="5.3" data-path="statistical-inference.html"><a href="statistical-inference.html#using-what-we-actually-know"><i class="fa fa-check"></i><b>5.3</b> Using what we actually know</a></li>
<li class="chapter" data-level="5.4" data-path="statistical-inference.html"><a href="statistical-inference.html#confidence-intervals-for-the-sample-mean"><i class="fa fa-check"></i><b>5.4</b> Confidence Intervals for the Sample Mean</a></li>
<li class="chapter" data-level="5.5" data-path="statistical-inference.html"><a href="statistical-inference.html#null-hypothesis-statistical-testing-nhst"><i class="fa fa-check"></i><b>5.5</b> Null Hypothesis Statistical Testing (NHST)</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="statistical-inference.html"><a href="statistical-inference.html#the-null-hypothesis"><i class="fa fa-check"></i><b>5.5.1</b> The null hypothesis</a></li>
<li class="chapter" data-level="5.5.2" data-path="statistical-inference.html"><a href="statistical-inference.html#statistical-inference-on-a-sample"><i class="fa fa-check"></i><b>5.5.2</b> Statistical inference on a sample</a></li>
<li class="chapter" data-level="5.5.3" data-path="statistical-inference.html"><a href="statistical-inference.html#nhst-considerations"><i class="fa fa-check"></i><b>5.5.3</b> NHST considerations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="statistical-inference.html"><a href="statistical-inference.html#learning-check-3"><i class="fa fa-check"></i>Learning check</a></li>
<li class="chapter" data-level="" data-path="statistical-inference.html"><a href="statistical-inference.html#references-2"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="supervised-learning.html"><a href="supervised-learning.html"><i class="fa fa-check"></i><b>6</b> Supervised learning</a>
<ul>
<li class="chapter" data-level="6.1" data-path="supervised-learning.html"><a href="supervised-learning.html#linear-regression"><i class="fa fa-check"></i><b>6.1</b> Linear regression</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="supervised-learning.html"><a href="supervised-learning.html#correlation"><i class="fa fa-check"></i><b>6.1.1</b> Correlation</a></li>
<li class="chapter" data-level="6.1.2" data-path="supervised-learning.html"><a href="supervised-learning.html#regression-analysis"><i class="fa fa-check"></i><b>6.1.2</b> Regression analysis</a></li>
<li class="chapter" data-level="6.1.3" data-path="supervised-learning.html"><a href="supervised-learning.html#categorical-predictors"><i class="fa fa-check"></i><b>6.1.3</b> Categorical predictors</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="supervised-learning.html"><a href="supervised-learning.html#logistic-regression"><i class="fa fa-check"></i><b>6.2</b> Logistic regression</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="supervised-learning.html"><a href="supervised-learning.html#motivation-and-intuition"><i class="fa fa-check"></i><b>6.2.1</b> Motivation and intuition</a></li>
<li class="chapter" data-level="6.2.2" data-path="supervised-learning.html"><a href="supervised-learning.html#technical-details-of-the-model"><i class="fa fa-check"></i><b>6.2.2</b> Technical details of the model</a></li>
<li class="chapter" data-level="6.2.3" data-path="supervised-learning.html"><a href="supervised-learning.html#estimation-in-r"><i class="fa fa-check"></i><b>6.2.3</b> Estimation in R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="supervised-learning.html"><a href="supervised-learning.html#learning-check-4"><i class="fa fa-check"></i>Learning check</a></li>
<li class="chapter" data-level="" data-path="supervised-learning.html"><a href="supervised-learning.html#references-3"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html"><i class="fa fa-check"></i><b>7</b> Unsupervised learning</a>
<ul>
<li class="chapter" data-level="7.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#principal-component-analysis"><i class="fa fa-check"></i><b>7.1</b> Principal component analysis</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#introduction-1"><i class="fa fa-check"></i><b>7.1.1</b> Introduction</a></li>
<li class="chapter" data-level="7.1.2" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#steps-in-factor-analysis"><i class="fa fa-check"></i><b>7.1.2</b> Steps in factor analysis</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#cluster-analysis"><i class="fa fa-check"></i><b>7.2</b> Cluster analysis</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#k-means"><i class="fa fa-check"></i><b>7.2.1</b> K-Means</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#learning-check-5"><i class="fa fa-check"></i>Learning check</a></li>
<li class="chapter" data-level="" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#references-4"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="part"><span><b>III Assignments</b></span></li>
<li class="chapter" data-level="8" data-path="r-markdown.html"><a href="r-markdown.html"><i class="fa fa-check"></i><b>8</b> R Markdown</a>
<ul>
<li class="chapter" data-level="8.1" data-path="r-markdown.html"><a href="r-markdown.html#introduction-to-r-markdown"><i class="fa fa-check"></i><b>8.1</b> Introduction to R Markdown</a>
<ul>
<li class="chapter" data-level="" data-path="r-markdown.html"><a href="r-markdown.html#creating-a-new-r-markdown-document"><i class="fa fa-check"></i>Creating a new R Markdown document</a></li>
<li class="chapter" data-level="" data-path="r-markdown.html"><a href="r-markdown.html#text-and-equations"><i class="fa fa-check"></i>Text and Equations</a></li>
<li class="chapter" data-level="" data-path="r-markdown.html"><a href="r-markdown.html#r-code"><i class="fa fa-check"></i>R-Code</a></li>
<li class="chapter" data-level="" data-path="r-markdown.html"><a href="r-markdown.html#latex-math"><i class="fa fa-check"></i>LaTeX Math</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="assignments-solutions.html"><a href="assignments-solutions.html"><i class="fa fa-check"></i><b>9</b> Assignments: Solutions</a>
<ul>
<li class="chapter" data-level="9.1" data-path="assignments-solutions.html"><a href="assignments-solutions.html#assignment-1"><i class="fa fa-check"></i><b>9.1</b> Assignment 1</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="assignments-solutions.html"><a href="assignments-solutions.html#load-data"><i class="fa fa-check"></i><b>9.1.1</b> Load data</a></li>
<li class="chapter" data-level="9.1.2" data-path="assignments-solutions.html"><a href="assignments-solutions.html#q1"><i class="fa fa-check"></i><b>9.1.2</b> Q1</a></li>
<li class="chapter" data-level="9.1.3" data-path="assignments-solutions.html"><a href="assignments-solutions.html#q2"><i class="fa fa-check"></i><b>9.1.3</b> Q2</a></li>
<li class="chapter" data-level="9.1.4" data-path="assignments-solutions.html"><a href="assignments-solutions.html#q3"><i class="fa fa-check"></i><b>9.1.4</b> Q3</a></li>
<li class="chapter" data-level="9.1.5" data-path="assignments-solutions.html"><a href="assignments-solutions.html#q4"><i class="fa fa-check"></i><b>9.1.5</b> Q4</a></li>
<li class="chapter" data-level="9.1.6" data-path="assignments-solutions.html"><a href="assignments-solutions.html#q5"><i class="fa fa-check"></i><b>9.1.6</b> Q5</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="assignments-solutions.html"><a href="assignments-solutions.html#assignment-2"><i class="fa fa-check"></i><b>9.2</b> Assignment 2</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="assignments-solutions.html"><a href="assignments-solutions.html#q1-1"><i class="fa fa-check"></i><b>9.2.1</b> Q1</a></li>
<li class="chapter" data-level="9.2.2" data-path="assignments-solutions.html"><a href="assignments-solutions.html#q2-1"><i class="fa fa-check"></i><b>9.2.2</b> Q2</a></li>
<li class="chapter" data-level="9.2.3" data-path="assignments-solutions.html"><a href="assignments-solutions.html#q3-1"><i class="fa fa-check"></i><b>9.2.3</b> Q3</a></li>
<li class="chapter" data-level="9.2.4" data-path="assignments-solutions.html"><a href="assignments-solutions.html#q4-1"><i class="fa fa-check"></i><b>9.2.4</b> Q4</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="assignments-solutions.html"><a href="assignments-solutions.html#assignment-3"><i class="fa fa-check"></i><b>9.3</b> Assignment 3</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="assignments-solutions.html"><a href="assignments-solutions.html#q1-2"><i class="fa fa-check"></i><b>9.3.1</b> Q1</a></li>
<li class="chapter" data-level="9.3.2" data-path="assignments-solutions.html"><a href="assignments-solutions.html#q2-2"><i class="fa fa-check"></i><b>9.3.2</b> Q2</a></li>
<li class="chapter" data-level="9.3.3" data-path="assignments-solutions.html"><a href="assignments-solutions.html#q3-2"><i class="fa fa-check"></i><b>9.3.3</b> Q3</a></li>
<li class="chapter" data-level="9.3.4" data-path="assignments-solutions.html"><a href="assignments-solutions.html#q4-2"><i class="fa fa-check"></i><b>9.3.4</b> Q4</a></li>
<li class="chapter" data-level="9.3.5" data-path="assignments-solutions.html"><a href="assignments-solutions.html#q5-1"><i class="fa fa-check"></i><b>9.3.5</b> Q5</a></li>
<li class="chapter" data-level="9.3.6" data-path="assignments-solutions.html"><a href="assignments-solutions.html#q6"><i class="fa fa-check"></i><b>9.3.6</b> Q6</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="group-project-1.html"><a href="group-project-1.html"><i class="fa fa-check"></i><b>10</b> Group project</a>
<ul>
<li class="chapter" data-level="10.1" data-path="group-project-1.html"><a href="group-project-1.html#data-analysis"><i class="fa fa-check"></i><b>10.1</b> Data analysis</a></li>
<li class="chapter" data-level="10.2" data-path="group-project-1.html"><a href="group-project-1.html#load-data-1"><i class="fa fa-check"></i><b>10.2</b> Load data</a></li>
<li class="chapter" data-level="10.3" data-path="group-project-1.html"><a href="group-project-1.html#question-1"><i class="fa fa-check"></i><b>10.3</b> Question 1</a></li>
<li class="chapter" data-level="10.4" data-path="group-project-1.html"><a href="group-project-1.html#question-2"><i class="fa fa-check"></i><b>10.4</b> Question 2</a></li>
<li class="chapter" data-level="10.5" data-path="group-project-1.html"><a href="group-project-1.html#question-3"><i class="fa fa-check"></i><b>10.5</b> Question 3</a></li>
<li class="chapter" data-level="10.6" data-path="group-project-1.html"><a href="group-project-1.html#question-4"><i class="fa fa-check"></i><b>10.6</b> Question 4</a></li>
</ul></li>
<li class="part"><span><b>IV FAQ</b></span></li>
<li class="chapter" data-level="11" data-path="faq.html"><a href="faq.html"><i class="fa fa-check"></i><b>11</b> FAQ</a>
<ul>
<li class="chapter" data-level="11.1" data-path="faq.html"><a href="faq.html#common-error-messages"><i class="fa fa-check"></i><b>11.1</b> Common error messages</a>
<ul>
<li class="chapter" data-level="" data-path="faq.html"><a href="faq.html#a-general-note-on-error-messages"><i class="fa fa-check"></i>A general note on error messages</a></li>
<li class="chapter" data-level="" data-path="faq.html"><a href="faq.html#error-in-filefile-rt-cannot-open-the-connection"><i class="fa fa-check"></i>Error in file(file, “rt”): cannot open the connection</a></li>
<li class="chapter" data-level="" data-path="faq.html"><a href="faq.html#error-unexpected-symbol-in-call"><i class="fa fa-check"></i>Error: unexpected ‘SYMBOL’ in “CALL”</a></li>
<li class="chapter" data-level="" data-path="faq.html"><a href="faq.html#error-in-call-object-of-type-closure-is-not-subsettable"><i class="fa fa-check"></i>Error in CALL : object of type ‘closure’ is not subsettable</a></li>
<li class="chapter" data-level="" data-path="faq.html"><a href="faq.html#error-in-call_with_-operator-is-invalid-for-atomic-vectors"><i class="fa fa-check"></i>Error in CALL_WITH_$: $ operator is invalid for atomic vectors</a></li>
<li class="chapter" data-level="" data-path="faq.html"><a href="faq.html#error-in-call-object-name-not-found"><i class="fa fa-check"></i>Error in CALL: object ‘NAME’ not found</a></li>
<li class="chapter" data-level="" data-path="faq.html"><a href="faq.html#error-in-call-could-not-find-function-function"><i class="fa fa-check"></i>Error in CALL: could not find function “FUNCTION”</a></li>
<li class="chapter" data-level="" data-path="faq.html"><a href="faq.html#error-in-call-incorrect-number-of-dimension"><i class="fa fa-check"></i>Error in CALL: incorrect number of dimension</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="faq.html"><a href="faq.html#installation-of-r-packages"><i class="fa fa-check"></i><b>11.2</b> Installation of R packages</a>
<ul>
<li class="chapter" data-level="" data-path="faq.html"><a href="faq.html#what-are-the-different-ways-to-install-r-packages"><i class="fa fa-check"></i>What are the different ways to install R packages?</a></li>
<li class="chapter" data-level="" data-path="faq.html"><a href="faq.html#i-cannot-install-packages-due-to-error-in-contrib.urlrepossource-or-warning-message-package-packagename-is-not-available-for-this-version-of-r"><i class="fa fa-check"></i>I cannot install packages due to “Error in contrib.url(repos,”source”)” or “Warning message: package ‘PACKAGENAME’ is not available for this version of R”</a></li>
<li class="chapter" data-level="" data-path="faq.html"><a href="faq.html#some-libraries-with-graphical-output-e.g.-summarytools-magick-fail-to-installload-properly-on-macos"><i class="fa fa-check"></i>Some libraries with graphical output (e.g., summarytools, magick) fail to install/load properly on MacOS</a></li>
<li class="chapter" data-level="" data-path="faq.html"><a href="faq.html#i-cannot-install-some-packages-on-macos"><i class="fa fa-check"></i>I cannot install some packages on MacOS</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="faq.html"><a href="faq.html#issues-with-statistics-and-data"><i class="fa fa-check"></i><b>11.3</b> Issues with statistics and data</a>
<ul>
<li class="chapter" data-level="" data-path="faq.html"><a href="faq.html#why-does-a-multi-item-scale-lead-to-increased-reliability"><i class="fa fa-check"></i>Why does a multi-item scale lead to increased reliability?</a></li>
<li class="chapter" data-level="" data-path="faq.html"><a href="faq.html#why-can-demeaningstandardization-lead-to-missing-values"><i class="fa fa-check"></i>Why can demeaning/standardization lead to missing values?</a></li>
<li class="chapter" data-level="" data-path="faq.html"><a href="faq.html#the-confidence-interval-ci-of-the-mean-seems-very-small-compared-to-the-dispersion-of-my-sample.-can-this-be-correct"><i class="fa fa-check"></i>The confidence interval (CI) of the mean seems very small compared to the dispersion of my sample. Can this be correct?</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="faq.html"><a href="faq.html#errors-related-to-specific-methods"><i class="fa fa-check"></i><b>11.4</b> Errors related to specific methods</a>
<ul>
<li class="chapter" data-level="" data-path="faq.html"><a href="faq.html#logistic-regression-1"><i class="fa fa-check"></i>Logistic regression</a></li>
<li class="chapter" data-level="" data-path="faq.html"><a href="faq.html#when-using-logistic-regression-error-in-weights-y-non-numeric-argument-to-binary-operator"><i class="fa fa-check"></i>When using logistic regression: Error in weights * y : non-numeric argument to binary operator</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="faq.html"><a href="faq.html#general-settings-and-options"><i class="fa fa-check"></i><b>11.5</b> General settings and options</a>
<ul>
<li class="chapter" data-level="" data-path="faq.html"><a href="faq.html#numbers-are-formatted-weirdly"><i class="fa fa-check"></i>Numbers are formatted weirdly</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="faq.html"><a href="faq.html#data-visualizationoutput-issues"><i class="fa fa-check"></i><b>11.6</b> Data visualization/output issues</a>
<ul>
<li class="chapter" data-level="" data-path="faq.html"><a href="faq.html#how-can-the-geom-colors-in-a-ggplot-be-changed"><i class="fa fa-check"></i>How can the <code>geom</code> colors in a <code>ggplot</code> be changed?</a></li>
<li class="chapter" data-level="" data-path="faq.html"><a href="faq.html#why-are-some-histograms-displayed-differently"><i class="fa fa-check"></i>Why are some histograms displayed differently?</a></li>
<li class="chapter" data-level="" data-path="faq.html"><a href="faq.html#some-labels-in-plots-are-cut-off.-how-can-i-extend-the-plot-margins"><i class="fa fa-check"></i>Some labels in plots are cut off. How can I extend the plot margins?</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="faq.html"><a href="faq.html#issues-with-functions-and-function-arguments"><i class="fa fa-check"></i><b>11.7</b> Issues with functions and function arguments</a>
<ul>
<li class="chapter" data-level="" data-path="faq.html"><a href="faq.html#problems-with-factor-and-as.factor"><i class="fa fa-check"></i>Problems with <code>factor</code> and <code>as.factor</code></a></li>
<li class="chapter" data-level="" data-path="faq.html"><a href="faq.html#how-can-i-find-an-explanation-of-the-output-of-a-function"><i class="fa fa-check"></i>How can I find an explanation of the output of a function?</a></li>
<li class="chapter" data-level="" data-path="faq.html"><a href="faq.html#what-does-the-margin-argument-do"><i class="fa fa-check"></i>What does the <code>MARGIN</code> argument do?</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="faq.html"><a href="faq.html#issues-with-r-markdown"><i class="fa fa-check"></i><b>11.8</b> Issues with R Markdown</a>
<ul>
<li class="chapter" data-level="" data-path="faq.html"><a href="faq.html#i-get-an-error-when-knitting-to-pdf-but-it-works-for-html"><i class="fa fa-check"></i>I get an error when <code>knit</code>ting to PDF but it works for HTML</a></li>
<li class="chapter" data-level="" data-path="faq.html"><a href="faq.html#i-am-not-sure-where-r-code-latex-math-and-text-go"><i class="fa fa-check"></i>I am not sure where R-code, LaTeX math, and text go</a></li>
</ul></li>
<li class="chapter" data-level="11.9" data-path="faq.html"><a href="faq.html#new-questions"><i class="fa fa-check"></i><b>11.9</b> New questions</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Retail Marketing Analytics 2024</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="assignments-solutions" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">9</span> Assignments: Solutions<a href="assignments-solutions.html#assignments-solutions" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="assignment-1" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Assignment 1<a href="assignments-solutions.html#assignment-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This is the <em>technical</em> solution for the first assignment (i.e., it does not include any interpretations while your solutions should have some for <em>each task</em>). Also, plase note that there are multiple possible ways of solving the assignment.</p>
<div id="load-data" class="section level3 hasAnchor" number="9.1.1">
<h3><span class="header-section-number">9.1.1</span> Load data<a href="assignments-solutions.html#load-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="assignments-solutions.html#cb418-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb418-2"><a href="assignments-solutions.html#cb418-2" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb418-3"><a href="assignments-solutions.html#cb418-3" tabindex="-1"></a></span>
<span id="cb418-4"><a href="assignments-solutions.html#cb418-4" tabindex="-1"></a>sales_data <span class="ot">&lt;-</span> <span class="fu">read.csv2</span>(<span class="st">&quot;https://raw.githubusercontent.com/WU-RDS/RMA2024/main/data/Sales-2019-2020_A1.csv&quot;</span>,</span>
<span id="cb418-5"><a href="assignments-solutions.html#cb418-5" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb418-6"><a href="assignments-solutions.html#cb418-6" tabindex="-1"></a>sales_data <span class="sc">%&lt;&gt;%</span></span>
<span id="cb418-7"><a href="assignments-solutions.html#cb418-7" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(date, <span class="at">format =</span> <span class="st">&quot;%m/%d/%Y&quot;</span>))</span>
<span id="cb418-8"><a href="assignments-solutions.html#cb418-8" tabindex="-1"></a>sales_data<span class="sc">$</span>year <span class="ot">&lt;-</span> <span class="fu">format</span>(sales_data<span class="sc">$</span>date, <span class="st">&quot;%Y&quot;</span>)</span>
<span id="cb418-9"><a href="assignments-solutions.html#cb418-9" tabindex="-1"></a>sales_data<span class="sc">$</span>order_value_EUR <span class="ot">&lt;-</span> <span class="fu">str_remove</span>(sales_data<span class="sc">$</span>order_value_EUR,</span>
<span id="cb418-10"><a href="assignments-solutions.html#cb418-10" tabindex="-1"></a>    <span class="st">&quot;,&quot;</span>)</span>
<span id="cb418-11"><a href="assignments-solutions.html#cb418-11" tabindex="-1"></a><span class="fu">str</span>(sales_data)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    1000 obs. of  11 variables:
##  $ country        : chr  &quot;Sweden&quot; &quot;Finland&quot; &quot;Portugal&quot; &quot;Portugal&quot; ...
##  $ order_value_EUR: chr  &quot;17524.02&quot; &quot;116563.40&quot; &quot;296465.56&quot; &quot;74532.02&quot; ...
##  $ cost           : chr  &quot;14122.61&quot; &quot;92807.78&quot; &quot;257480.34&quot; &quot;59752.32&quot; ...
##  $ date           : Date, format: &quot;2020-02-12&quot; &quot;2019-09-26&quot; ...
##  $ category       : chr  &quot;Books&quot; &quot;Games&quot; &quot;Clothing&quot; &quot;Beauty&quot; ...
##  $ customer_name  : chr  &quot;Goldner-Dibbert&quot; &quot;Hilll-Vandervort&quot; &quot;Larkin-Collier&quot; &quot;Hessel-Stiedemann&quot; ...
##  $ sales_manager  : chr  &quot;Maxie Marrow&quot; &quot;Hube Corey&quot; &quot;Celine Tumasian&quot; &quot;Celine Tumasian&quot; ...
##  $ sales_rep      : chr  &quot;Madelon Bront&quot; &quot;Wat Bowkley&quot; &quot;Smitty Culverhouse&quot; &quot;Aurelie Wren&quot; ...
##  $ device_type    : chr  &quot;Mobile&quot; &quot;Mobile&quot; &quot;PC&quot; &quot;PC&quot; ...
##  $ order_id       : chr  &quot;70-0511466&quot; &quot;28-6585323&quot; &quot;58-7703341&quot; &quot;14-6700183&quot; ...
##  $ year           : chr  &quot;2020&quot; &quot;2019&quot; &quot;2019&quot; &quot;2020&quot; ...</code></pre>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="assignments-solutions.html#cb420-1" tabindex="-1"></a><span class="co"># head(sales_data)</span></span></code></pre></div>
<p>First, you should check the data and make sure all variables are recorded correctly (correct variable types). From the output above you can see that <code>order_value_EUR</code> and <code>cost</code>, which are measured in ratio scales, are not numeric. Hence, you need to fix this:</p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="assignments-solutions.html#cb421-1" tabindex="-1"></a>sales_data<span class="sc">$</span>order_value_EUR <span class="ot">=</span> <span class="fu">as.numeric</span>(sales_data<span class="sc">$</span>order_value_EUR)</span>
<span id="cb421-2"><a href="assignments-solutions.html#cb421-2" tabindex="-1"></a>sales_data<span class="sc">$</span>cost <span class="ot">=</span> <span class="fu">as.numeric</span>(sales_data<span class="sc">$</span>cost)</span>
<span id="cb421-3"><a href="assignments-solutions.html#cb421-3" tabindex="-1"></a><span class="fu">head</span>(sales_data, <span class="dv">2</span>)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["country"],"name":[1],"type":["chr"],"align":["left"]},{"label":["order_value_EUR"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["cost"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["date"],"name":[4],"type":["date"],"align":["right"]},{"label":["category"],"name":[5],"type":["chr"],"align":["left"]},{"label":["customer_name"],"name":[6],"type":["chr"],"align":["left"]},{"label":["sales_manager"],"name":[7],"type":["chr"],"align":["left"]},{"label":["sales_rep"],"name":[8],"type":["chr"],"align":["left"]},{"label":["device_type"],"name":[9],"type":["chr"],"align":["left"]},{"label":["order_id"],"name":[10],"type":["chr"],"align":["left"]},{"label":["year"],"name":[11],"type":["chr"],"align":["left"]}],"data":[{"1":"Sweden","2":"17524.02","3":"14122.61","4":"2020-02-12","5":"Books","6":"Goldner-Dibbert","7":"Maxie Marrow","8":"Madelon Bront","9":"Mobile","10":"70-0511466","11":"2020"},{"1":"Finland","2":"116563.40","3":"92807.78","4":"2019-09-26","5":"Games","6":"Hilll-Vandervort","7":"Hube Corey","8":"Wat Bowkley","9":"Mobile","10":"28-6585323","11":"2019"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="q1" class="section level3 hasAnchor" number="9.1.2">
<h3><span class="header-section-number">9.1.2</span> Q1<a href="assignments-solutions.html#q1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To solve the first task of Question 1, ypu could simply use the <code>table()</code> and <code>arrange()</code> functions. By storing the table as data frame, you allow for using it in the bar plot as well:</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="assignments-solutions.html#cb422-1" tabindex="-1"></a>prop <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(sales_data<span class="sc">$</span>country))</span>
<span id="cb422-2"><a href="assignments-solutions.html#cb422-2" tabindex="-1"></a>prop <span class="ot">&lt;-</span> prop <span class="sc">%&gt;%</span></span>
<span id="cb422-3"><a href="assignments-solutions.html#cb422-3" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(Freq))</span>
<span id="cb422-4"><a href="assignments-solutions.html#cb422-4" tabindex="-1"></a>prop</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Var1"],"name":[1],"type":["fct"],"align":["left"]},{"label":["Freq"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"Portugal","2":"239"},{"1":"France","2":"232"},{"1":"Sweden","2":"182"},{"1":"UK","2":"101"},{"1":"Finland","2":"44"},{"1":"Ireland","2":"43"},{"1":"Bulgaria","2":"30"},{"1":"Netherlands","2":"28"},{"1":"Spain","2":"26"},{"1":"Germany","2":"24"},{"1":"Luxembourg","2":"22"},{"1":"Denmark","2":"11"},{"1":"Italy","2":"10"},{"1":"Belgium","2":"6"},{"1":"Austria","2":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="assignments-solutions.html#cb423-1" tabindex="-1"></a><span class="fu">ggplot</span>(prop, <span class="fu">aes</span>(<span class="at">x =</span> Var1, <span class="at">y =</span> Freq)) <span class="sc">+</span> <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(Var1,</span>
<span id="cb423-2"><a href="assignments-solutions.html#cb423-2" tabindex="-1"></a>    <span class="sc">-</span>Freq), <span class="at">fill =</span> Freq)) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Number of transactions&quot;</span>) <span class="sc">+</span></span>
<span id="cb423-3"><a href="assignments-solutions.html#cb423-3" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;Market&quot;</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,</span>
<span id="cb423-4"><a href="assignments-solutions.html#cb423-4" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="fl">1.1</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code></pre></div>
<p><img src="09-rmdIntro_files/figure-html/question_1-1.png" width="672" /></p>
<p>For the next task, it was enough to use conditional frequencies <em>by year</em> (because this way, the audience sees the dynamics of transactions shares between markets in Y1 and Y2), or you could show the percentage changes for each market from Y1 to Y2.</p>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="assignments-solutions.html#cb424-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(<span class="fu">select</span>(sales_data, country,</span>
<span id="cb424-2"><a href="assignments-solutions.html#cb424-2" tabindex="-1"></a>    year)), <span class="dv">2</span>), <span class="dv">3</span>) <span class="sc">*</span> <span class="dv">100</span></span></code></pre></div>
<pre><code>##              year
## country       2019 2020
##   Austria      0.0  0.4
##   Belgium      0.4  0.8
##   Bulgaria     3.1  2.9
##   Denmark      0.8  1.4
##   Finland      4.5  4.3
##   France      26.1 20.4
##   Germany      2.2  2.5
##   Ireland      3.1  5.5
##   Italy        0.8  1.2
##   Luxembourg   2.7  1.8
##   Netherlands  2.2  3.3
##   Portugal    21.0 26.7
##   Spain        3.1  2.2
##   Sweden      19.2 17.3
##   UK          10.8  9.4</code></pre>
</div>
<div id="q2" class="section level3 hasAnchor" number="9.1.3">
<h3><span class="header-section-number">9.1.3</span> Q2<a href="assignments-solutions.html#q2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this task, you should simply perform grouping and summarizing. The only difference is, in task 1, you only needed one grouping variable (year), while in task 2, you had to use country as well.</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="assignments-solutions.html#cb426-1" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> sales_data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">annual_revenue =</span> <span class="fu">sum</span>(order_value_EUR), <span class="at">avg_revenue =</span> <span class="fu">mean</span>(order_value_EUR))</span>
<span id="cb426-2"><a href="assignments-solutions.html#cb426-2" tabindex="-1"></a>s1</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["year"],"name":[1],"type":["chr"],"align":["left"]},{"label":["annual_revenue"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["avg_revenue"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"2019","2":"56617524","3":"115546.0"},{"1":"2020","2":"56744214","3":"111263.2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="assignments-solutions.html#cb427-1" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> sales_data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(country, year) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">annual_revenue =</span> <span class="fu">sum</span>(order_value_EUR), <span class="at">avg_revenue =</span> <span class="fu">mean</span>(order_value_EUR)) </span>
<span id="cb427-2"><a href="assignments-solutions.html#cb427-2" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(s2)</span>
<span id="cb427-3"><a href="assignments-solutions.html#cb427-3" tabindex="-1"></a>s2</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["country"],"name":[1],"type":["chr"],"align":["left"]},{"label":["year"],"name":[2],"type":["chr"],"align":["left"]},{"label":["annual_revenue"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["avg_revenue"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"Austria","2":"2020","3":"190166.4","4":"95083.18"},{"1":"Belgium","2":"2019","3":"228554.3","4":"114277.15"},{"1":"Belgium","2":"2020","3":"380415.6","4":"95103.91"},{"1":"Bulgaria","2":"2019","3":"1909415.2","4":"127294.35"},{"1":"Bulgaria","2":"2020","3":"1572729.4","4":"104848.63"},{"1":"Denmark","2":"2019","3":"336460.0","4":"84115.01"},{"1":"Denmark","2":"2020","3":"426743.5","4":"60963.35"},{"1":"Finland","2":"2019","3":"2538029.1","4":"115364.96"},{"1":"Finland","2":"2020","3":"3010005.9","4":"136818.45"},{"1":"France","2":"2019","3":"14723094.3","4":"115024.17"},{"1":"France","2":"2020","3":"11177584.1","4":"107476.77"},{"1":"Germany","2":"2019","3":"1409637.3","4":"128148.85"},{"1":"Germany","2":"2020","3":"1384411.2","4":"106493.17"},{"1":"Ireland","2":"2019","3":"2308991.1","4":"153932.74"},{"1":"Ireland","2":"2020","3":"2643293.6","4":"94403.34"},{"1":"Italy","2":"2019","3":"459532.1","4":"114883.02"},{"1":"Italy","2":"2020","3":"476037.2","4":"79339.54"},{"1":"Luxembourg","2":"2019","3":"1672315.1","4":"128639.62"},{"1":"Luxembourg","2":"2020","3":"1241235.3","4":"137915.04"},{"1":"Netherlands","2":"2019","3":"1015879.3","4":"92352.66"},{"1":"Netherlands","2":"2020","3":"2208785.5","4":"129928.56"},{"1":"Portugal","2":"2019","3":"11722952.8","4":"113815.08"},{"1":"Portugal","2":"2020","3":"16073409.1","4":"118186.83"},{"1":"Spain","2":"2019","3":"1489665.7","4":"99311.04"},{"1":"Spain","2":"2020","3":"1009573.9","4":"91779.44"},{"1":"Sweden","2":"2019","3":"10403214.5","4":"110672.49"},{"1":"Sweden","2":"2020","3":"9233989.9","4":"104931.70"},{"1":"UK","2":"2019","3":"6399783.6","4":"120750.63"},{"1":"UK","2":"2020","3":"5715833.7","4":"119079.87"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="assignments-solutions.html#cb428-1" tabindex="-1"></a>sales_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2020</span>) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span> </span>
<span id="cb428-2"><a href="assignments-solutions.html#cb428-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(country, order_value_EUR),</span>
<span id="cb428-3"><a href="assignments-solutions.html#cb428-3" tabindex="-1"></a>    <span class="at">y =</span> order_value_EUR<span class="sc">/</span><span class="dv">1000</span>)) <span class="sc">+</span> <span class="co"># to have nicely readable axis points</span></span>
<span id="cb428-4"><a href="assignments-solutions.html#cb428-4" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">coef =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Country&quot;</span>,</span>
<span id="cb428-5"><a href="assignments-solutions.html#cb428-5" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Sales (in tsd)&quot;</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb428-6"><a href="assignments-solutions.html#cb428-6" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="fl">1.1</span>,</span>
<span id="cb428-7"><a href="assignments-solutions.html#cb428-7" tabindex="-1"></a>        <span class="at">hjust =</span> <span class="dv">1</span>), <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb428-8"><a href="assignments-solutions.html#cb428-8" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">&quot;#666666&quot;</span>), <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="09-rmdIntro_files/figure-html/question_2-1.png" width="672" /></p>
</div>
<div id="q3" class="section level3 hasAnchor" number="9.1.4">
<h3><span class="header-section-number">9.1.4</span> Q3<a href="assignments-solutions.html#q3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here are the two ways to solve Question 3: one with <code>mutate()</code> and another with <code>summarize()</code>. You can see that the second way is slightly more parsimonious.
Reminder: ROI is calculated as (( total revenue - total cost) / total cost ) * 100.</p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="assignments-solutions.html#cb429-1" tabindex="-1"></a>roi_mut <span class="ot">&lt;-</span> sales_data <span class="sc">%&gt;%</span></span>
<span id="cb429-2"><a href="assignments-solutions.html#cb429-2" tabindex="-1"></a>    <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb429-3"><a href="assignments-solutions.html#cb429-3" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">roi_index =</span> (<span class="fu">sum</span>(order_value_EUR) <span class="sc">-</span> <span class="fu">sum</span>(cost))<span class="sc">/</span><span class="fu">sum</span>(cost) <span class="sc">*</span></span>
<span id="cb429-4"><a href="assignments-solutions.html#cb429-4" tabindex="-1"></a>        <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb429-5"><a href="assignments-solutions.html#cb429-5" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(roi_index)) <span class="sc">%&gt;%</span></span>
<span id="cb429-6"><a href="assignments-solutions.html#cb429-6" tabindex="-1"></a>    <span class="fu">select</span>(country, roi_index) <span class="sc">%&gt;%</span></span>
<span id="cb429-7"><a href="assignments-solutions.html#cb429-7" tabindex="-1"></a>    <span class="fu">unique</span>()</span>
<span id="cb429-8"><a href="assignments-solutions.html#cb429-8" tabindex="-1"></a>roi_mut</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["country"],"name":[1],"type":["chr"],"align":["left"]},{"label":["roi_index"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"Austria","2":"23.12648"},{"1":"Denmark","2":"21.17211"},{"1":"Bulgaria","2":"21.04475"},{"1":"UK","2":"20.39093"},{"1":"Portugal","2":"20.19396"},{"1":"Sweden","2":"20.15162"},{"1":"Ireland","2":"20.11442"},{"1":"France","2":"20.10141"},{"1":"Germany","2":"20.01462"},{"1":"Italy","2":"19.92777"},{"1":"Spain","2":"19.89351"},{"1":"Luxembourg","2":"19.85066"},{"1":"Netherlands","2":"19.47191"},{"1":"Finland","2":"19.34466"},{"1":"Belgium","2":"18.35307"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="assignments-solutions.html#cb430-1" tabindex="-1"></a>roi_sum <span class="ot">&lt;-</span> sales_data <span class="sc">%&gt;%</span></span>
<span id="cb430-2"><a href="assignments-solutions.html#cb430-2" tabindex="-1"></a>    <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb430-3"><a href="assignments-solutions.html#cb430-3" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">roi_index =</span> (<span class="fu">sum</span>(order_value_EUR) <span class="sc">-</span> <span class="fu">sum</span>(cost))<span class="sc">/</span><span class="fu">sum</span>(cost) <span class="sc">*</span></span>
<span id="cb430-4"><a href="assignments-solutions.html#cb430-4" tabindex="-1"></a>        <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb430-5"><a href="assignments-solutions.html#cb430-5" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(roi_index))</span>
<span id="cb430-6"><a href="assignments-solutions.html#cb430-6" tabindex="-1"></a>roi_sum</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["country"],"name":[1],"type":["chr"],"align":["left"]},{"label":["roi_index"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"Austria","2":"23.12648"},{"1":"Denmark","2":"21.17211"},{"1":"Bulgaria","2":"21.04475"},{"1":"UK","2":"20.39093"},{"1":"Portugal","2":"20.19396"},{"1":"Sweden","2":"20.15162"},{"1":"Ireland","2":"20.11442"},{"1":"France","2":"20.10141"},{"1":"Germany","2":"20.01462"},{"1":"Italy","2":"19.92777"},{"1":"Spain","2":"19.89351"},{"1":"Luxembourg","2":"19.85066"},{"1":"Netherlands","2":"19.47191"},{"1":"Finland","2":"19.34466"},{"1":"Belgium","2":"18.35307"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="assignments-solutions.html#cb431-1" tabindex="-1"></a><span class="fu">head</span>(roi_mut, <span class="dv">3</span>)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["country"],"name":[1],"type":["chr"],"align":["left"]},{"label":["roi_index"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"Austria","2":"23.12648"},{"1":"Denmark","2":"21.17211"},{"1":"Bulgaria","2":"21.04475"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="assignments-solutions.html#cb432-1" tabindex="-1"></a><span class="fu">tail</span>(roi_mut, <span class="dv">3</span>)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["country"],"name":[1],"type":["chr"],"align":["left"]},{"label":["roi_index"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"Netherlands","2":"19.47191"},{"1":"Finland","2":"19.34466"},{"1":"Belgium","2":"18.35307"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="q4" class="section level3 hasAnchor" number="9.1.5">
<h3><span class="header-section-number">9.1.5</span> Q4<a href="assignments-solutions.html#q4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This task is quite similar to the prevoius one and could be solved the same way:</p>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="assignments-solutions.html#cb433-1" tabindex="-1"></a>categories <span class="ot">&lt;-</span> sales_data <span class="sc">%&gt;%</span></span>
<span id="cb433-2"><a href="assignments-solutions.html#cb433-2" tabindex="-1"></a>    <span class="fu">group_by</span>(category) <span class="sc">%&gt;%</span></span>
<span id="cb433-3"><a href="assignments-solutions.html#cb433-3" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">profit =</span> (<span class="fu">sum</span>(order_value_EUR) <span class="sc">-</span> <span class="fu">sum</span>(cost))) <span class="sc">%&gt;%</span></span>
<span id="cb433-4"><a href="assignments-solutions.html#cb433-4" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(profit)) <span class="sc">%&gt;%</span></span>
<span id="cb433-5"><a href="assignments-solutions.html#cb433-5" tabindex="-1"></a>    <span class="fu">select</span>(category, profit) <span class="sc">%&gt;%</span></span>
<span id="cb433-6"><a href="assignments-solutions.html#cb433-6" tabindex="-1"></a>    <span class="fu">unique</span>() <span class="sc">%&gt;%</span></span>
<span id="cb433-7"><a href="assignments-solutions.html#cb433-7" tabindex="-1"></a>    <span class="fu">head</span>(<span class="dv">5</span>)  <span class="co"># could also be done with summarize() like in the previous task</span></span>
<span id="cb433-8"><a href="assignments-solutions.html#cb433-8" tabindex="-1"></a>categories</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["category"],"name":[1],"type":["chr"],"align":["left"]},{"label":["profit"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"Clothing","2":"2941938"},{"1":"Games","2":"2559796"},{"1":"Appliances","2":"2534879"},{"1":"Electronics","2":"2401133"},{"1":"Books","2":"2225914"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="q5" class="section level3 hasAnchor" number="9.1.6">
<h3><span class="header-section-number">9.1.6</span> Q5<a href="assignments-solutions.html#q5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The tricky part in this task could be with “share of sales” - remember that share of sales is a share of revenue, gained by the device type, against the total revenue. This is <strong>not counting</strong> (i.e., <code>prop.table()</code> would not be the right way to solve this). Instead, you should use the sums of revenues per device type to obtain the shares:</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="assignments-solutions.html#cb434-1" tabindex="-1"></a>device_sales <span class="ot">&lt;-</span> sales_data <span class="sc">%&gt;%</span></span>
<span id="cb434-2"><a href="assignments-solutions.html#cb434-2" tabindex="-1"></a>    <span class="fu">group_by</span>(device_type) <span class="sc">%&gt;%</span></span>
<span id="cb434-3"><a href="assignments-solutions.html#cb434-3" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">sales =</span> <span class="fu">sum</span>(order_value_EUR))</span>
<span id="cb434-4"><a href="assignments-solutions.html#cb434-4" tabindex="-1"></a>device_sales <span class="sc">%&gt;%</span></span>
<span id="cb434-5"><a href="assignments-solutions.html#cb434-5" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">share_of_sales_percentage =</span> <span class="fu">round</span>(sales<span class="sc">/</span><span class="fu">sum</span>(sales),</span>
<span id="cb434-6"><a href="assignments-solutions.html#cb434-6" tabindex="-1"></a>        <span class="dv">4</span>) <span class="sc">*</span> <span class="dv">100</span>)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["device_type"],"name":[1],"type":["chr"],"align":["left"]},{"label":["sales"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["share_of_sales_percentage"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"Mobile","2":"15447394","3":"13.63"},{"1":"PC","2":"89647284","3":"79.08"},{"1":"Tablet","2":"8267061","3":"7.29"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div id="assignment-2" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Assignment 2<a href="assignments-solutions.html#assignment-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="assignments-solutions.html#cb435-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb435-2"><a href="assignments-solutions.html#cb435-2" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb435-3"><a href="assignments-solutions.html#cb435-3" tabindex="-1"></a><span class="fu">library</span>(Hmisc)</span>
<span id="cb435-4"><a href="assignments-solutions.html#cb435-4" tabindex="-1"></a><span class="fu">library</span>(ggstatsplot)</span>
<span id="cb435-5"><a href="assignments-solutions.html#cb435-5" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)</span>
<span id="cb435-6"><a href="assignments-solutions.html#cb435-6" tabindex="-1"></a></span>
<span id="cb435-7"><a href="assignments-solutions.html#cb435-7" tabindex="-1"></a>sales_data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;https://raw.githubusercontent.com/IMSMWU/MRDA2018/master/data/assignment4.dat&quot;</span>,</span>
<span id="cb435-8"><a href="assignments-solutions.html#cb435-8" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)  <span class="co">#read in data</span></span>
<span id="cb435-9"><a href="assignments-solutions.html#cb435-9" tabindex="-1"></a>sales_data<span class="sc">$</span>market_id <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(sales_data)</span>
<span id="cb435-10"><a href="assignments-solutions.html#cb435-10" tabindex="-1"></a><span class="fu">head</span>(sales_data)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["tv_adspend"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["online_adspend"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["radio_adspend"],"name":[3],"type":["int"],"align":["right"]},{"label":["sales"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["market_id"],"name":[5],"type":["int"],"align":["right"]}],"data":[{"1":"68.6","2":"10.3","3":"24","4":"8.6","5":"1"},{"1":"136.6","2":"29.0","3":"40","4":"15.8","5":"2"},{"1":"14.5","2":"44.3","3":"25","4":"11.8","5":"3"},{"1":"214.6","2":"26.2","3":"40","4":"17.1","5":"4"},{"1":"285.0","2":"13.9","3":"31","4":"17.4","5":"5"},{"1":"139.6","2":"74.9","3":"24","4":"24.4","5":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="assignments-solutions.html#cb436-1" tabindex="-1"></a><span class="fu">str</span>(sales_data)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    236 obs. of  5 variables:
##  $ tv_adspend    : num  68.6 136.6 14.5 214.6 285 ...
##  $ online_adspend: num  10.3 29 44.3 26.2 13.9 74.9 31.1 14.1 24.5 13.9 ...
##  $ radio_adspend : int  24 40 25 40 31 24 12 9 38 18 ...
##  $ sales         : num  8.6 15.8 11.8 17.1 17.4 24.4 19.5 4.7 20.7 19.5 ...
##  $ market_id     : int  1 2 3 4 5 6 7 8 9 10 ...</code></pre>
<div id="q1-1" class="section level3 hasAnchor" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> Q1<a href="assignments-solutions.html#q1-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In a first step, we specify the regression equation. In this case, sales is the <strong>dependent variable</strong> which is regressed on the different types of advertising expenditures that represent the <strong>independent variables</strong> for product <em>i</em>. Thus, the regression equation is:</p>
<p><span class="math display">\[sales_{i}=\beta_0 + \beta_1 * tv\_adspend_{i} + \beta_2 * online\_adspend_{i} + \beta_3 * radio\_adspend_{i} + \epsilon\]</span></p>
<p>This equation will be used later to turn the output of the regression analysis (namely the coefficients: <span class="math inline">\(\beta_0\)</span> - intersect coefficient, and <span class="math inline">\(\beta_1\)</span>, <span class="math inline">\(\beta_2\)</span>, and <span class="math inline">\(\beta_3\)</span> that represent the unknown relationship between sales and advertising expenditures on TV, online channels and radio, respectively) to the “managerial” form and draw marketing conclusions.</p>
</div>
<div id="q2-1" class="section level3 hasAnchor" number="9.2.2">
<h3><span class="header-section-number">9.2.2</span> Q2<a href="assignments-solutions.html#q2-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The descriptive statistics for the variables can be checked using the <code>describe()</code> function:</p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="assignments-solutions.html#cb438-1" tabindex="-1"></a>psych<span class="sc">::</span><span class="fu">describe</span>(sales_data)</span></code></pre></div>
<pre><code>##                vars   n   mean    sd median trimmed    mad min   max range skew
## tv_adspend        1 236 148.65 89.77 141.85  147.45 117.27 1.1 299.6 298.5 0.12
## online_adspend    2 236  25.61 14.33  24.35   24.70  14.53 1.6  74.9  73.3 0.61
## radio_adspend     3 236  27.70 12.57  27.00   27.36  13.34 2.0  63.0  61.0 0.22
## sales             4 236  14.83  5.40  14.15   14.72   5.93 1.4  29.0  27.6 0.16
## market_id         5 236 118.50 68.27 118.50  118.50  87.47 1.0 236.0 235.0 0.00
##                kurtosis   se
## tv_adspend        -1.26 5.84
## online_adspend     0.08 0.93
## radio_adspend     -0.53 0.82
## sales             -0.57 0.35
## market_id         -1.22 4.44</code></pre>
<p>Inspecting the correlation matrix reveals that the sales variable is positively correlated with TV advertising and online advertising expenditures. The correlations among the independent variables appear to be low to moderate.</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="assignments-solutions.html#cb440-1" tabindex="-1"></a><span class="fu">rcorr</span>(<span class="fu">as.matrix</span>(sales_data[, <span class="fu">c</span>(<span class="st">&quot;sales&quot;</span>, <span class="st">&quot;tv_adspend&quot;</span>,</span>
<span id="cb440-2"><a href="assignments-solutions.html#cb440-2" tabindex="-1"></a>    <span class="st">&quot;online_adspend&quot;</span>, <span class="st">&quot;radio_adspend&quot;</span>)]))</span></code></pre></div>
<pre><code>##                sales tv_adspend online_adspend radio_adspend
## sales           1.00       0.78           0.54         -0.04
## tv_adspend      0.78       1.00           0.05          0.03
## online_adspend  0.54       0.05           1.00         -0.07
## radio_adspend  -0.04       0.03          -0.07          1.00
## 
## n= 236 
## 
## 
## P
##                sales  tv_adspend online_adspend radio_adspend
## sales                 0.0000     0.0000         0.5316       
## tv_adspend     0.0000            0.4127         0.6735       
## online_adspend 0.0000 0.4127                    0.2790       
## radio_adspend  0.5316 0.6735     0.2790</code></pre>
<p>Since we have continuous variables, we use scatterplots to investigate the relationship between sales and each of the predictor variables.</p>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="assignments-solutions.html#cb442-1" tabindex="-1"></a><span class="fu">ggplot</span>(sales_data, <span class="fu">aes</span>(<span class="at">x =</span> tv_adspend, <span class="at">y =</span> sales)) <span class="sc">+</span></span>
<span id="cb442-2"><a href="assignments-solutions.html#cb442-2" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb442-3"><a href="assignments-solutions.html#cb442-3" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">color =</span> <span class="st">&quot;lavenderblush3&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb442-4"><a href="assignments-solutions.html#cb442-4" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb442-5"><a href="assignments-solutions.html#cb442-5" tabindex="-1"></a><span class="fu">ggplot</span>(sales_data, <span class="fu">aes</span>(<span class="at">x =</span> online_adspend, <span class="at">y =</span> sales)) <span class="sc">+</span></span>
<span id="cb442-6"><a href="assignments-solutions.html#cb442-6" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb442-7"><a href="assignments-solutions.html#cb442-7" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">color =</span> <span class="st">&quot;lavenderblush3&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb442-8"><a href="assignments-solutions.html#cb442-8" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb442-9"><a href="assignments-solutions.html#cb442-9" tabindex="-1"></a><span class="fu">ggplot</span>(sales_data, <span class="fu">aes</span>(<span class="at">x =</span> radio_adspend, <span class="at">y =</span> sales)) <span class="sc">+</span></span>
<span id="cb442-10"><a href="assignments-solutions.html#cb442-10" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb442-11"><a href="assignments-solutions.html#cb442-11" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">color =</span> <span class="st">&quot;lavenderblush3&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb442-12"><a href="assignments-solutions.html#cb442-12" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="09-rmdIntro_files/figure-html/unnamed-chunk-6-1.png" width="50%" /><img src="09-rmdIntro_files/figure-html/unnamed-chunk-6-2.png" width="50%" /><img src="09-rmdIntro_files/figure-html/unnamed-chunk-6-3.png" width="50%" /></p>
<p>The plots including the fitted lines from a simple linear model already suggest that there might be a positive linear relationship between sales and TV- and online-advertising. However, there does not appear to be a strong relationship between sales and radio advertising.</p>
<p>Further steps include estimate of a multiple linear regression model in order to determine the relative influence of each type of advertising on sales.</p>
</div>
<div id="q3-1" class="section level3 hasAnchor" number="9.2.3">
<h3><span class="header-section-number">9.2.3</span> Q3<a href="assignments-solutions.html#q3-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The estimate the model, we will use the <code>lm()</code> function:</p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="assignments-solutions.html#cb443-1" tabindex="-1"></a>linear_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> tv_adspend <span class="sc">+</span> online_adspend <span class="sc">+</span></span>
<span id="cb443-2"><a href="assignments-solutions.html#cb443-2" tabindex="-1"></a>    radio_adspend, <span class="at">data =</span> sales_data)</span></code></pre></div>
<p>In a next step, we will investigate the results from the model using the <code>summary()</code> function.</p>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="assignments-solutions.html#cb444-1" tabindex="-1"></a><span class="fu">summary</span>(linear_model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = sales ~ tv_adspend + online_adspend + radio_adspend, 
##     data = sales_data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.1113 -1.4161 -0.0656  1.3233  5.5198 
## 
## Coefficients:
##                 Estimate Std. Error t value             Pr(&gt;|t|)    
## (Intercept)     3.604140   0.460057   7.834    0.000000000000169 ***
## tv_adspend      0.045480   0.001491  30.508 &lt; 0.0000000000000002 ***
## online_adspend  0.186859   0.009359  19.965 &lt; 0.0000000000000002 ***
## radio_adspend  -0.011469   0.010656  -1.076                0.283    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.048 on 232 degrees of freedom
## Multiple R-squared:  0.8582, Adjusted R-squared:  0.8564 
## F-statistic: 468.1 on 3 and 232 DF,  p-value: &lt; 0.00000000000000022</code></pre>
<p>For each of the individual predictors, we test the following hypothesis:</p>
<p><span class="math display">\[H_0: \beta_k=0\]</span>
<span class="math display">\[H_1: \beta_k\ne0\]</span></p>
<p>where k denotes the number of the regression coefficient. In the present example, we reject the null hypothesis for tv_adspend and online_adspend, where we observe a significant effect (i.e., p-value &lt; 0.05). However, we fail to reject the null for the “radio_adspend” variable (i.e., the effect is insignificant).</p>
<p>The interpretation of the coefficients is as follows:</p>
<ul>
<li>tv_adspend (β<sub>1</sub>): when TV advertising expenditures increase by 1000 Euro, sales will increase by 45 units;</li>
<li>online_adspend (β<sub>2</sub>): when online advertising expenditures increase by 1000 Euro, sales will increase by 187 units;</li>
<li>radio_adspend (β<sub>3</sub>): when radio advertising expenditures increase by 1000 Euro, sales will increase by -11 units (i.e., decrease by 11 units).</li>
</ul>
<p>You should always provide a measure of uncertainty that is associated with the estimates. You could compute the confidence intervals around the coefficients using the <code>confint()</code> function.</p>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="assignments-solutions.html#cb446-1" tabindex="-1"></a><span class="fu">confint</span>(linear_model)</span></code></pre></div>
<pre><code>##                      2.5 %     97.5 %
## (Intercept)     2.69771633 4.51056393
## tv_adspend      0.04254244 0.04841668
## online_adspend  0.16841843 0.20529924
## radio_adspend  -0.03246402 0.00952540</code></pre>
<p>The results show that, for example, the 95% confidence interval associated with coefficient capturing the effect of online advertising on sales is between 0.168 and 0.205.</p>
<p>Regarding the model fit, the R<sup>2</sup> statistic tells us that <strong>approximately 86% of the variance can be explained by the model</strong>. This can be visualized as follows:</p>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="assignments-solutions.html#cb448-1" tabindex="-1"></a>sales_data<span class="sc">$</span>yhat <span class="ot">&lt;-</span> <span class="fu">predict</span>(linear_model)</span>
<span id="cb448-2"><a href="assignments-solutions.html#cb448-2" tabindex="-1"></a><span class="fu">ggplot</span>(sales_data, <span class="fu">aes</span>(yhat, sales)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb448-3"><a href="assignments-solutions.html#cb448-3" tabindex="-1"></a>    <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">&quot;predicted values&quot;</span>) <span class="sc">+</span></span>
<span id="cb448-4"><a href="assignments-solutions.html#cb448-4" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">&quot;observed values&quot;</span>) <span class="sc">+</span></span>
<span id="cb448-5"><a href="assignments-solutions.html#cb448-5" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="09-rmdIntro_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>In addition, the output tells us that our predictions on average deviate from the observed values by 2048 units (see residual standard error, remember that the sales variable is measures in thousand units).</p>
<p>Of course, you could have also used the functions included in the ggstatsplot package to report the results from your regression model.</p>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="assignments-solutions.html#cb449-1" tabindex="-1"></a><span class="fu">ggcoefstats</span>(<span class="at">x =</span> linear_model, <span class="at">k =</span> <span class="dv">3</span>, <span class="at">title =</span> <span class="st">&quot;Sales predicted by TV-, online-, &amp; radio advertising&quot;</span>)</span></code></pre></div>
<p><img src="09-rmdIntro_files/figure-html/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="q4-1" class="section level3 hasAnchor" number="9.2.4">
<h3><span class="header-section-number">9.2.4</span> Q4<a href="assignments-solutions.html#q4-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Finally, we can predict the outcome for the given marketing mix using the following equation:</p>
<p><span class="math display">\[\hat{Sales} = \beta_0 + \beta_1*150 + \beta_2*26 + \beta_3*15 \]</span></p>
<p>The coefficients can be extracted from the summary of the linear model and used for quick sales value prediction as follows:</p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="assignments-solutions.html#cb450-1" tabindex="-1"></a><span class="fu">summary</span>(linear_model)<span class="sc">$</span>coefficients[<span class="dv">1</span>, <span class="dv">1</span>] <span class="sc">+</span> <span class="fu">summary</span>(linear_model)<span class="sc">$</span>coefficients[<span class="dv">2</span>,</span>
<span id="cb450-2"><a href="assignments-solutions.html#cb450-2" tabindex="-1"></a>    <span class="dv">1</span>] <span class="sc">*</span> <span class="dv">150</span> <span class="sc">+</span> <span class="fu">summary</span>(linear_model)<span class="sc">$</span>coefficients[<span class="dv">3</span>,</span>
<span id="cb450-3"><a href="assignments-solutions.html#cb450-3" tabindex="-1"></a>    <span class="dv">1</span>] <span class="sc">*</span> <span class="dv">26</span> <span class="sc">+</span> <span class="fu">summary</span>(linear_model)<span class="sc">$</span>coefficients[<span class="dv">4</span>,</span>
<span id="cb450-4"><a href="assignments-solutions.html#cb450-4" tabindex="-1"></a>    <span class="dv">1</span>] <span class="sc">*</span> <span class="dv">15</span></span></code></pre></div>
<pre><code>## [1] 15.11236</code></pre>
<p><span class="math display">\[\hat{sales}= 3.6 + 0.045*150 + 0.187*26 + 0.011*15 = 15.11\]</span></p>
<p>This means that given the planned marketing mix, we would expect to sell around 15,112 units.</p>
</div>
</div>
<div id="assignment-3" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> Assignment 3<a href="assignments-solutions.html#assignment-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="assignments-solutions.html#cb452-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb452-2"><a href="assignments-solutions.html#cb452-2" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb452-3"><a href="assignments-solutions.html#cb452-3" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb452-4"><a href="assignments-solutions.html#cb452-4" tabindex="-1"></a><span class="fu">library</span>(ggiraph)</span>
<span id="cb452-5"><a href="assignments-solutions.html#cb452-5" tabindex="-1"></a><span class="fu">library</span>(ggiraphExtra)</span>
<span id="cb452-6"><a href="assignments-solutions.html#cb452-6" tabindex="-1"></a><span class="fu">library</span>(NbClust)</span>
<span id="cb452-7"><a href="assignments-solutions.html#cb452-7" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb452-8"><a href="assignments-solutions.html#cb452-8" tabindex="-1"></a><span class="fu">library</span>(GPArotation)</span>
<span id="cb452-9"><a href="assignments-solutions.html#cb452-9" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)</span>
<span id="cb452-10"><a href="assignments-solutions.html#cb452-10" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb452-11"><a href="assignments-solutions.html#cb452-11" tabindex="-1"></a>track_data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;https://raw.githubusercontent.com/WU-RDS/RMA2022/main/data/tracks_cluster.csv&quot;</span>,</span>
<span id="cb452-12"><a href="assignments-solutions.html#cb452-12" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;;&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">dec =</span> <span class="st">&quot;,&quot;</span>)  <span class="co">#read data</span></span>
<span id="cb452-13"><a href="assignments-solutions.html#cb452-13" tabindex="-1"></a><span class="fu">str</span>(track_data)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    672 obs. of  14 variables:
##  $ isrc            : chr  &quot;USCM51700084&quot; &quot;USUM71601827&quot; &quot;USCM51600080&quot; &quot;USCM51500238&quot; ...
##  $ trackName       : chr  &quot;Fake Love&quot; &quot;Into You&quot; &quot;Controlla&quot; &quot;Hotline Bling&quot; ...
##  $ artistName      : chr  &quot;Drake&quot; &quot;Ariana Grande&quot; &quot;Drake&quot; &quot;Drake&quot; ...
##  $ danceability    : num  0.928 0.636 0.607 0.903 0.49 0.56 0.638 0.356 0.513 0.653 ...
##  $ energy          : num  0.481 0.727 0.476 0.62 0.743 0.442 0.924 0.924 0.683 0.839 ...
##  $ loudness        : num  -9.35 -5.85 -11.08 -8.09 -5.16 ...
##  $ mode            : int  0 1 0 1 0 1 1 1 1 1 ...
##  $ speechiness     : num  0.287 0.106 0.249 0.0587 0.0409 0.0243 0.0359 0.0808 0.032 0.0685 ...
##  $ acousticness    : num  0.105 0.0161 0.0773 0.0035 0.255 0.727 0.002 0.001 0.339 0.0369 ...
##  $ instrumentalness: num  0 0.00000112 0 0.0001 0.00000721 0 0.0002 0 0.739 0 ...
##  $ liveness        : num  0.176 0.151 0.113 0.0504 0.3 0.11 0.149 0.0953 0.0871 0.068 ...
##  $ valence         : num  0.613 0.358 0.347 0.539 0.363 0.212 0.529 0.232 0.153 0.669 ...
##  $ tempo           : num  134 108 123 135 90 ...
##  $ duration_ms     : int  210937 244453 245227 267067 258827 309600 263787 222587 355172 216281 ...</code></pre>
<div id="q1-2" class="section level3 hasAnchor" number="9.3.1">
<h3><span class="header-section-number">9.3.1</span> Q1<a href="assignments-solutions.html#q1-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can standardize the relevant variables as follows:</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="assignments-solutions.html#cb454-1" tabindex="-1"></a><span class="co"># standardize variables track_data &lt;-</span></span>
<span id="cb454-2"><a href="assignments-solutions.html#cb454-2" tabindex="-1"></a><span class="co"># distinct(track_data)</span></span>
<span id="cb454-3"><a href="assignments-solutions.html#cb454-3" tabindex="-1"></a>track_data_scale <span class="ot">&lt;-</span> track_data <span class="sc">%&gt;%</span></span>
<span id="cb454-4"><a href="assignments-solutions.html#cb454-4" tabindex="-1"></a>    <span class="fu">mutate_at</span>(<span class="fu">vars</span>(danceability<span class="sc">:</span>duration_ms), scale)</span>
<span id="cb454-5"><a href="assignments-solutions.html#cb454-5" tabindex="-1"></a>track_data_scale <span class="ot">&lt;-</span> track_data_scale <span class="sc">%&gt;%</span></span>
<span id="cb454-6"><a href="assignments-solutions.html#cb454-6" tabindex="-1"></a>    <span class="fu">mutate_at</span>(<span class="fu">vars</span>(danceability<span class="sc">:</span>duration_ms), as.vector)</span></code></pre></div>
</div>
<div id="q2-2" class="section level3 hasAnchor" number="9.3.2">
<h3><span class="header-section-number">9.3.2</span> Q2<a href="assignments-solutions.html#q2-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now we can create histograms of the respective variables to inspect their distributions:</p>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="assignments-solutions.html#cb455-1" tabindex="-1"></a><span class="fu">ggplot</span>(track_data_scale, <span class="fu">aes</span>(<span class="at">x =</span> danceability)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb455-2"><a href="assignments-solutions.html#cb455-2" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;lavenderblush3&quot;</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="09-rmdIntro_files/figure-html/question_2_13-1.png" width="672" /></p>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="assignments-solutions.html#cb456-1" tabindex="-1"></a><span class="fu">ggplot</span>(track_data_scale, <span class="fu">aes</span>(<span class="at">x =</span> energy)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb456-2"><a href="assignments-solutions.html#cb456-2" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;lavenderblush3&quot;</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="09-rmdIntro_files/figure-html/question_2_13-2.png" width="672" /></p>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="assignments-solutions.html#cb457-1" tabindex="-1"></a><span class="fu">ggplot</span>(track_data_scale, <span class="fu">aes</span>(<span class="at">x =</span> loudness)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb457-2"><a href="assignments-solutions.html#cb457-2" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;lavenderblush3&quot;</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="09-rmdIntro_files/figure-html/question_2_13-3.png" width="672" /></p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="assignments-solutions.html#cb458-1" tabindex="-1"></a><span class="fu">ggplot</span>(track_data_scale, <span class="fu">aes</span>(<span class="at">x =</span> mode)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb458-2"><a href="assignments-solutions.html#cb458-2" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;lavenderblush3&quot;</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="09-rmdIntro_files/figure-html/question_2_13-4.png" width="672" /></p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="assignments-solutions.html#cb459-1" tabindex="-1"></a><span class="fu">ggplot</span>(track_data_scale, <span class="fu">aes</span>(<span class="at">x =</span> speechiness)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb459-2"><a href="assignments-solutions.html#cb459-2" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;lavenderblush3&quot;</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="09-rmdIntro_files/figure-html/question_2_13-5.png" width="672" /></p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="assignments-solutions.html#cb460-1" tabindex="-1"></a><span class="fu">ggplot</span>(track_data_scale, <span class="fu">aes</span>(<span class="at">x =</span> acousticness)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb460-2"><a href="assignments-solutions.html#cb460-2" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;lavenderblush3&quot;</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="09-rmdIntro_files/figure-html/question_2_13-6.png" width="672" /></p>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="assignments-solutions.html#cb461-1" tabindex="-1"></a><span class="fu">ggplot</span>(track_data_scale, <span class="fu">aes</span>(<span class="at">x =</span> instrumentalness)) <span class="sc">+</span></span>
<span id="cb461-2"><a href="assignments-solutions.html#cb461-2" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;lavenderblush3&quot;</span>) <span class="sc">+</span></span>
<span id="cb461-3"><a href="assignments-solutions.html#cb461-3" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="09-rmdIntro_files/figure-html/question_2_13-7.png" width="672" /></p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="assignments-solutions.html#cb462-1" tabindex="-1"></a><span class="fu">ggplot</span>(track_data_scale, <span class="fu">aes</span>(<span class="at">x =</span> liveness)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb462-2"><a href="assignments-solutions.html#cb462-2" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;lavenderblush3&quot;</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="09-rmdIntro_files/figure-html/question_2_13-8.png" width="672" /></p>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="assignments-solutions.html#cb463-1" tabindex="-1"></a><span class="fu">ggplot</span>(track_data_scale, <span class="fu">aes</span>(<span class="at">x =</span> valence)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb463-2"><a href="assignments-solutions.html#cb463-2" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;lavenderblush3&quot;</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="09-rmdIntro_files/figure-html/question_2_13-9.png" width="672" /></p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="assignments-solutions.html#cb464-1" tabindex="-1"></a><span class="fu">ggplot</span>(track_data_scale, <span class="fu">aes</span>(<span class="at">x =</span> tempo)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb464-2"><a href="assignments-solutions.html#cb464-2" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;lavenderblush3&quot;</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="09-rmdIntro_files/figure-html/question_2_13-10.png" width="672" /></p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="assignments-solutions.html#cb465-1" tabindex="-1"></a><span class="fu">ggplot</span>(track_data_scale, <span class="fu">aes</span>(<span class="at">x =</span> duration_ms)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb465-2"><a href="assignments-solutions.html#cb465-2" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;lavenderblush3&quot;</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="09-rmdIntro_files/figure-html/question_2_13-11.png" width="672" /></p>
<p>The distributions of the variables reveal nothing that would disqualify them from being included in the cluster analysis (e.g., severe outliers, etc.).</p>
</div>
<div id="q3-2" class="section level3 hasAnchor" number="9.3.3">
<h3><span class="header-section-number">9.3.3</span> Q3<a href="assignments-solutions.html#q3-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The optimal number of clusters may be derived as follows (recall that you might get different results due to different starting values for the algorithm):</p>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="assignments-solutions.html#cb466-1" tabindex="-1"></a><span class="co"># optimal number of clusters</span></span>
<span id="cb466-2"><a href="assignments-solutions.html#cb466-2" tabindex="-1"></a>opt_K <span class="ot">&lt;-</span> <span class="fu">NbClust</span>(track_data_scale <span class="sc">%&gt;%</span></span>
<span id="cb466-3"><a href="assignments-solutions.html#cb466-3" tabindex="-1"></a>    <span class="fu">select</span>(danceability<span class="sc">:</span>duration_ms), <span class="at">method =</span> <span class="st">&quot;kmeans&quot;</span>,</span>
<span id="cb466-4"><a href="assignments-solutions.html#cb466-4" tabindex="-1"></a>    <span class="at">max.nc =</span> <span class="dv">11</span>)</span></code></pre></div>
<p><img src="09-rmdIntro_files/figure-html/question_3_13-1.png" width="672" /></p>
<pre><code>## *** : The Hubert index is a graphical method of determining the number of clusters.
##                 In the plot of Hubert index, we seek a significant knee that corresponds to a 
##                 significant increase of the value of the measure i.e the significant peak in Hubert
##                 index second differences plot. 
## </code></pre>
<p><img src="09-rmdIntro_files/figure-html/question_3_13-2.png" width="672" /></p>
<pre><code>## *** : The D index is a graphical method of determining the number of clusters. 
##                 In the plot of D index, we seek a significant knee (the significant peak in Dindex
##                 second differences plot) that corresponds to a significant increase of the value of
##                 the measure. 
##  
## ******************************************************************* 
## * Among all indices:                                                
## * 6 proposed 2 as the best number of clusters 
## * 7 proposed 3 as the best number of clusters 
## * 5 proposed 6 as the best number of clusters 
## * 1 proposed 8 as the best number of clusters 
## * 3 proposed 10 as the best number of clusters 
## * 2 proposed 11 as the best number of clusters 
## 
##                    ***** Conclusion *****                            
##  
## * According to the majority rule, the best number of clusters is  3 
##  
##  
## *******************************************************************</code></pre>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="assignments-solutions.html#cb469-1" tabindex="-1"></a><span class="fu">table</span>(opt_K<span class="sc">$</span>Best.nc[<span class="st">&quot;Number_clusters&quot;</span>, ])</span></code></pre></div>
<pre><code>## 
##  0  2  3  6  8 10 11 
##  2  6  7  5  1  3  2</code></pre>
<p>According to the output, the optimal number of clusters is 3 (see the majority rule).</p>
</div>
<div id="q4-2" class="section level3 hasAnchor" number="9.3.4">
<h3><span class="header-section-number">9.3.4</span> Q4<a href="assignments-solutions.html#q4-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now we can run the analysis using 3 clusters by simply executing this code:</p>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="assignments-solutions.html#cb471-1" tabindex="-1"></a>kmeans_tracks <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(track_data_scale <span class="sc">%&gt;%</span></span>
<span id="cb471-2"><a href="assignments-solutions.html#cb471-2" tabindex="-1"></a>    <span class="fu">select</span>(danceability<span class="sc">:</span>duration_ms), <span class="dv">3</span>)</span></code></pre></div>
</div>
<div id="q5-1" class="section level3 hasAnchor" number="9.3.5">
<h3><span class="header-section-number">9.3.5</span> Q5<a href="assignments-solutions.html#q5-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can describe and characterize the clusters as follows. In a first step, we can inspect the mean values of the cluster variables by cluster.</p>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="assignments-solutions.html#cb472-1" tabindex="-1"></a>kmeans_tracks<span class="sc">$</span>centers</span></code></pre></div>
<pre><code>##   danceability     energy    loudness       mode speechiness acousticness
## 1   -0.2602781  0.2417217  0.01501135  0.2147370  0.52514714   -0.2406802
## 2    0.1636830  0.3459136  0.38654145 -0.1179780  0.08249594   -0.3530631
## 3   -0.4121850 -1.2841741 -1.30190556  0.2829333 -0.55017187    1.3075661
##   instrumentalness   liveness     valence        tempo  duration_ms
## 1       -0.2361200  2.3128056  0.02472127 -0.004596109 -0.002528358
## 2       -0.2007537 -0.2636833  0.21054905  0.060654445 -0.063026825
## 3        0.7952815 -0.3239152 -0.71777967 -0.200662562  0.212321991</code></pre>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="assignments-solutions.html#cb474-1" tabindex="-1"></a>centers <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(kmeans_tracks<span class="sc">$</span>centers)</span>
<span id="cb474-2"><a href="assignments-solutions.html#cb474-2" tabindex="-1"></a>centers<span class="sc">$</span>cluster <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb474-3"><a href="assignments-solutions.html#cb474-3" tabindex="-1"></a><span class="fu">ggRadar</span>(centers, <span class="fu">aes</span>(<span class="at">color =</span> cluster), <span class="at">rescale =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb474-4"><a href="assignments-solutions.html#cb474-4" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Centers&quot;</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="09-rmdIntro_files/figure-html/question_5_13-1.png" width="672" /></p>
<p>This analysis reveals that there is one cluster (cluster 1) that exhibits comparatively high levels of liveness and speechiness and another cluster (cluster 3) that is characterized by high levels of acousticness and instrumentalness. Cluster 2 appears to have moderate values on all dimensions.</p>
<p>We can further characterize the clusters by inspecting the artists in each cluster:</p>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="assignments-solutions.html#cb475-1" tabindex="-1"></a>track_data<span class="sc">$</span>cluster <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(kmeans_tracks<span class="sc">$</span>cluster)</span>
<span id="cb475-2"><a href="assignments-solutions.html#cb475-2" tabindex="-1"></a><span class="fu">ggplot</span>(track_data, <span class="fu">aes</span>(<span class="at">y =</span> cluster, <span class="at">fill =</span> artistName)) <span class="sc">+</span></span>
<span id="cb475-3"><a href="assignments-solutions.html#cb475-3" tabindex="-1"></a>    <span class="fu">geom_bar</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="09-rmdIntro_files/figure-html/question_5_23-1.png" width="672" /></p>
<p>We can also count how many songs each artist has in each cluster:</p>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="assignments-solutions.html#cb476-1" tabindex="-1"></a><span class="fu">table</span>(track_data<span class="sc">$</span>artistName, track_data<span class="sc">$</span>cluster)</span></code></pre></div>
<pre><code>##                
##                  1  2  3
##   Ariana Grande  1 42  9
##   Billie Eilish  2  9 32
##   Capital Bra    5 50  2
##   Coldplay       8 29 30
##   Drake         16 62 15
##   Foo Fighters   3 29  2
##   Kollegah      13 36  0
##   Kontra K       5 52  0
##   Linkin Park   11 45  2
##   Taylor Swift   4 70 37
##   The Killers    0 23  2
##   U2             4 15  7</code></pre>
<p>It appears that cluster 1 consists of songs by rap artists such as Kontra K, Cpaital Bra, and Drake, while cluster 3 consists of songs by artists such as Coldplay and Taylor Swift. Cluster 2 is a mix of songs by different artists. This appears consistent with the analysis of the song features from the previous plot.</p>
<p>Finally, we can group the songs by cluster and visualize their association with the first two principal components from a pca-analysis. Although this reduces the information compared to the original 11 variables, we cannot meaningfully display the 11 dimensions in detail.</p>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="assignments-solutions.html#cb478-1" tabindex="-1"></a><span class="fu">fviz_cluster</span>(kmeans_tracks, <span class="at">data =</span> track_data_scale <span class="sc">%&gt;%</span></span>
<span id="cb478-2"><a href="assignments-solutions.html#cb478-2" tabindex="-1"></a>    <span class="fu">select</span>(danceability<span class="sc">:</span>duration_ms), <span class="at">palette =</span> <span class="fu">hcl.colors</span>(<span class="dv">3</span>,</span>
<span id="cb478-3"><a href="assignments-solutions.html#cb478-3" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">&quot;Dynamic&quot;</span>), <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">ellipse.type =</span> <span class="st">&quot;convex&quot;</span>,</span>
<span id="cb478-4"><a href="assignments-solutions.html#cb478-4" tabindex="-1"></a>    <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>())</span></code></pre></div>
<p><img src="09-rmdIntro_files/figure-html/question_5_43-1.png" width="672" /></p>
<p>Although the two dimensions only represent a fraction (approx. 41%) of the variation across the 11 dimensions, the plot shows that the cluster separates the songs rather well, since each cluster has a sizable area that is not overlapping with any of the other clusters.</p>
</div>
<div id="q6" class="section level3 hasAnchor" number="9.3.6">
<h3><span class="header-section-number">9.3.6</span> Q6<a href="assignments-solutions.html#q6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For our playlist, let’s first see in which cluster the song is:</p>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="assignments-solutions.html#cb479-1" tabindex="-1"></a>track_data <span class="sc">%&gt;%</span></span>
<span id="cb479-2"><a href="assignments-solutions.html#cb479-2" tabindex="-1"></a>    <span class="fu">filter</span>(trackName <span class="sc">==</span> <span class="st">&quot;Monkey Wrench&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb479-3"><a href="assignments-solutions.html#cb479-3" tabindex="-1"></a>    <span class="fu">select</span>(trackName, artistName, cluster)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["trackName"],"name":[1],"type":["chr"],"align":["left"]},{"label":["artistName"],"name":[2],"type":["chr"],"align":["left"]},{"label":["cluster"],"name":[3],"type":["fct"],"align":["left"]}],"data":[{"1":"Monkey Wrench","2":"Foo Fighters","3":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>The song is in cluster number 2, so we can select any song from this cluster for our playlist:</p>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="assignments-solutions.html#cb480-1" tabindex="-1"></a>recommendations <span class="ot">&lt;-</span> track_data <span class="sc">%&gt;%</span></span>
<span id="cb480-2"><a href="assignments-solutions.html#cb480-2" tabindex="-1"></a>    <span class="fu">filter</span>(cluster <span class="sc">==</span> <span class="dv">2</span>)</span>
<span id="cb480-3"><a href="assignments-solutions.html#cb480-3" tabindex="-1"></a><span class="fu">head</span>(recommendations)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["isrc"],"name":[1],"type":["chr"],"align":["left"]},{"label":["trackName"],"name":[2],"type":["chr"],"align":["left"]},{"label":["artistName"],"name":[3],"type":["chr"],"align":["left"]},{"label":["danceability"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["energy"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["loudness"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["mode"],"name":[7],"type":["int"],"align":["right"]},{"label":["speechiness"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["acousticness"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["instrumentalness"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["liveness"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["valence"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["tempo"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["duration_ms"],"name":[14],"type":["int"],"align":["right"]},{"label":["cluster"],"name":[15],"type":["fct"],"align":["left"]}],"data":[{"1":"USCM51700084","2":"Fake Love","3":"Drake","4":"0.928","5":"0.481","6":"-9.350","7":"0","8":"0.2870","9":"0.1050","10":"0.00000000","11":"0.1760","12":"0.613","13":"134.007","14":"210937","15":"2"},{"1":"USUM71601827","2":"Into You","3":"Ariana Grande","4":"0.636","5":"0.727","6":"-5.852","7":"1","8":"0.1060","9":"0.0161","10":"0.00000112","11":"0.1510","12":"0.358","13":"107.988","14":"244453","15":"2"},{"1":"USCM51600080","2":"Controlla","3":"Drake","4":"0.607","5":"0.476","6":"-11.076","7":"0","8":"0.2490","9":"0.0773","10":"0.00000000","11":"0.1130","12":"0.347","13":"122.976","14":"245227","15":"2"},{"1":"USCM51500238","2":"Hotline Bling","3":"Drake","4":"0.903","5":"0.620","6":"-8.094","7":"1","8":"0.0587","9":"0.0035","10":"0.00010000","11":"0.0504","12":"0.539","13":"134.960","14":"267067","15":"2"},{"1":"GBAYE1500979","2":"Hymn for the Weekend","3":"Coldplay","4":"0.490","5":"0.743","6":"-5.155","7":"0","8":"0.0409","9":"0.2550","10":"0.00000721","11":"0.3000","12":"0.363","13":"89.974","14":"258827","15":"2"},{"1":"GBAYE1500981","2":"Adventure of a Lifetime","3":"Coldplay","4":"0.638","5":"0.924","6":"-3.887","7":"1","8":"0.0359","9":"0.0020","10":"0.00020000","11":"0.1490","12":"0.529","13":"111.995","14":"263787","15":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="r-markdown.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="group-project-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
